<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4 max-w-2xl">
        <h1 class="text-3xl font-bold mb-6 text-center text-blue-600">Todo List</h1>
        
        <form id="todo-form" class="flex flex-col md:flex-row mb-6 gap-2">
            <input type="text" id="title" placeholder="Tiêu đề (bắt buộc)" class="flex-1 border border-gray-300 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
            <input type="text" id="description" placeholder="Mô tả (tùy chọn)" class="flex-1 border border-gray-300 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button type="submit" class="bg-blue-500 text-white p-2 rounded-md hover:bg-blue-600 transition">Thêm</button>
        </form>
        
       
        <div class="flex justify-center mb-6 gap-2">
            <button onclick="filterTasks('all')" class="bg-gray-200 p-2 rounded-md hover:bg-gray-300 transition">Tất cả</button>
            <button onclick="filterTasks('pending')" class="bg-gray-200 p-2 rounded-md hover:bg-gray-300 transition">Chưa hoàn thành</button>
            <button onclick="filterTasks('completed')" class="bg-gray-200 p-2 rounded-md hover:bg-gray-300 transition">Hoàn thành</button>
        </div>
        
        
        <ul id="todo-list" class="space-y-4"></ul>
    </div>

    <script>
        let tasks = [];
        let currentFilter = 'all';


        if (localStorage.getItem('tasks')) {
            tasks = JSON.parse(localStorage.getItem('tasks'));
        }

      
        function renderTasks(filter = currentFilter) {
            currentFilter = filter;
            const list = document.getElementById('todo-list');
            list.innerHTML = '';
            
            let filteredTasks = tasks;
            if (filter === 'pending') {
                filteredTasks = tasks.filter(t => !t.completed);
            } else if (filter === 'completed') {
                filteredTasks = tasks.filter(t => t.completed);
            }
            
            
            filteredTasks.sort((a, b) => b.createdAt - a.createdAt);
            
            if (filteredTasks.length === 0) {
                list.innerHTML = '<p class="text-center text-gray-500">Không có công việc nào.</p>';
                return;
            }
            
            filteredTasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.classList.add('bg-white', 'p-4', 'rounded-md', 'shadow-md', 'flex', 'flex-col', 'md:flex-row', 'justify-between', 'items-start', 'md:items-center', 'gap-4');
                if (task.completed) li.classList.add('bg-green-50');
                
                li.innerHTML = `
                    <div class="flex-1">
                        <h3 class="font-bold text-lg ${task.completed ? 'line-through text-gray-500' : ''}">${task.title}</h3>
                        <p class="text-gray-600">${task.description || 'Không có mô tả'}</p>
                        <p class="text-sm text-gray-400">Tạo lúc: ${new Date(task.createdAt).toLocaleString('vi-VN')}</p>
                    </div>
                    <div class="flex gap-2 mt-2 md:mt-0">
                        <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="toggleComplete(${index})" class="cursor-pointer">
                        <button onclick="editTask(${index})" class="bg-yellow-500 text-white px-3 py-1 rounded-md hover:bg-yellow-600 transition">Sửa</button>
                        <button onclick="deleteTask(${index})" class="bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 transition">Xóa</button>
                    </div>
                `;
                list.appendChild(li);
            });
        }

       
        document.getElementById('todo-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            if (!title) return alert('Tiêu đề là bắt buộc!');
            
            tasks.push({
                title,
                description,
                createdAt: Date.now(),
                completed: false
            });
            
            localStorage.setItem('tasks', JSON.stringify(tasks));
            renderTasks();
            e.target.reset();
        });

        
        function toggleComplete(index) {
            tasks[index].completed = !tasks[index].completed;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            renderTasks();
        }

       
        function deleteTask(index) {
            if (confirm('Bạn chắc chắn muốn xóa?')) {
                tasks.splice(index, 1);
                localStorage.setItem('tasks', JSON.stringify(tasks));
                renderTasks();
            }
        }

        
        function editTask(index) {
            const newTitle = prompt('Tiêu đề mới:', tasks[index].title);
            const newDesc = prompt('Mô tả mới:', tasks[index].description);
            if (newTitle !== null && newTitle.trim()) {
                tasks[index].title = newTitle.trim();
                tasks[index].description = newDesc ? newDesc.trim() : '';
                localStorage.setItem('tasks', JSON.stringify(tasks));
                renderTasks();
            }
        }

        
        function filterTasks(filter) {
            renderTasks(filter);
        }


        renderTasks();
    </script>
</body>
</html>